<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
	<meta name="generator" content="Hugo 0.124.1">
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>Алексей Пахунов</title>

  
  <link rel="stylesheet" href="/css/poole.css">
  <link rel="stylesheet" href="/css/hyde.css">
  <link rel="stylesheet" href="/css/poole-overrides.css">
  <link rel="stylesheet" href="/css/hyde-overrides.css">
  <link rel="stylesheet" href="/css/hyde-x.css">
  <link rel="stylesheet" href="/css/highlight/github.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="/css/custom.css">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/touch-icon-144-precomposed.png">
  <link href="/favicon.png" rel="icon">

  
  
  <link href="/index.xml" rel="alternate" type="application/rss+xml" title="Алексей Пахунов" />

  <meta name="description" content="Блог про космос, программирование и всякое разное.">
  <meta name="keywords" content="">
  
</head>
<body>
<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      
      <h1>Алексей Пахунов</h1>
      <p class="lead">&hellip; также известный как &ldquo;Not a kernel guy&rdquo;</p>
    </div>

    <ul class="sidebar-nav">
      <li class="sidebar-nav-item"><a href="/">Блог</a></li>
      
      <li class="sidebar-nav-item"><a href="/post/">Архив</a></li>
      
      <li class="sidebar-nav-item"><a href="/about">Об авторе</a></li>
      
      <li class="sidebar-nav-item"><a href="/index.xml">Подписаться на RSS канал</a></li>
      
      <li class="sidebar-nav-item"><a href="https://follow.it/fucjll?action=followPub">Почтовая рассылка</a></li>
      
    </ul>

    <ul class="sidebar-nav">
      <script>
        (function() {
          var cx = '009966018894572705542:ewu98_itf-q';
          var gcse = document.createElement('script');
          gcse.type = 'text/javascript';
          gcse.async = true;
          gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
              '//cse.google.com/cse/cse.js?cx=' + cx;
          var s = document.getElementsByTagName('script')[0];
          s.parentNode.insertBefore(gcse, s);
        })();
      </script>
      <gcse:searchbox-only></gcse:searchbox-only>
    </ul>

    <ul class="sidebar-nav">
      <li class="sidebar-nav-item">
      
      
      
      <a href="https://www.linkedin.com/in/alexpakhunov"><i class="fa fa-linkedin-square fa-3x"></i></a>
      
      
      
      
      
      <a href="/index.xml" type="application/rss+xml"><i class="fa fa-rss-square fa-3x"></i></a>
    </li>
    </ul>

    

    <p>Copyright &copy; 2006 - 2025 <a href="/license/">License</a><br/>
       Powered by <a href="http://gohugo.io">Hugo</a> and <a href="https://github.com/zyro/hyde-x">Hyde-X</a></p>

  </div>
</div>


<div class="content container">
  <div class="posts">
    
    <ul class="pagination">
  <li class="active">
    <span class="fa-lg"><a href="/page/26/" aria-label="Previous">
        <i class="fa fa-arrow-left" aria-hidden="true"></i>&nbsp;Новое
      </a></span>
  </li>

  <li class="active">
    <span class="fa-lg">
      <a href="/post/">Архив</a>
    <span>
  </li>

  <li class="active">
    <span class="fa-lg"><a href="/page/28/" aria-label="Next">
        Старое&nbsp;<i class="fa fa-arrow-right" aria-hidden="true"></i>
      </a></span>
  </li>
</ul>

    
    <div class="post">
      <h1 class="post-title">
        <a href="https://blog.not-a-kernel-guy.com/2011/04/07/1020/">Inception</a>
      </h1>
      <span class="post-date">Apr 7, 2011 &middot; <a href="https://blog.not-a-kernel-guy.com/2011/04/07/1020/#disqus_thread">Comments</a>
      
      <br/>
      <a class="label" href="/tags/%D0%BE%D1%82%D0%BB%D0%B0%D0%B4%D0%BA%D0%B0">Отладка</a>
      </span>
      
      <p>Сижу я сегодня на работе, никого не трогаю, отладчиком отладчик отлаживаю. А что, отладчик - тоже <!-- raw HTML omitted -->человек<!-- raw HTML omitted --> программа. Тем более что немногим ранее я его немножко совсем поломал, пытаясь добавить поддержку некоей конфигурации, которая текущей реинкарнацией отладчика не поддерживается. Ну вот, запускаю я его примерно вот таким образом:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-no-highlight" data-lang="no-highlight"><span style="display:flex;"><span>windbg.exe kd.exe -k com:port=com1,baud=115200
</span></span></code></pre></div><p>…и замечаю, что что-то не так. А именно - опять сломался наш корпоративный прокси. А я как раз хотел посмотреть в… ну скажем MSDN. Попробовал и так и сяк. Не работает, вылетает по таймауту. Ну хорошо, но тут начитают происходить еще более мистические вещи. Outlook вдруг перестает реагировать мышь и клавиатуру; IE вообще не запускается – процесс стартует, но окно не показывается. Несколько подозрительно для проблем с прокси.</p>
      <a href="https://blog.not-a-kernel-guy.com/2011/04/07/1020/">Read On &rarr;</a>
      
    </div>
    
    <div class="post">
      <h1 class="post-title">
        <a href="https://blog.not-a-kernel-guy.com/2011/04/02/1015/">РИТ&#43;&#43;, секция «RootConf»</a>
      </h1>
      <span class="post-date">Apr 2, 2011 &middot; <a href="https://blog.not-a-kernel-guy.com/2011/04/02/1015/#disqus_thread">Comments</a>
      
      <br/>
      <a class="label" href="/tags/%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5">Программирование</a><a class="label" href="/tags/%D1%80%D0%B8%D1%82&#43;&#43;">РИТ&#43;&#43;</a><a class="label" href="/tags/windows">Windows</a><a class="label" href="/tags/windows-kernel">Windows Kernel</a>
      </span>
      
      Меня пригласили выступить на конференции РИТ++ 2011, которая пройдет в Москве в конце апреля. Предварительная тема доклада: «Сетевая подсистема Windows глазами разработчика. Краткий, неполный и, в основном, неверный обзор. :-)» Я собираюсь рассказать о том, как работает ядерная часть сетевой подсистемы, как данные попадают в user mode и что с ними происходит по пути. Заходите на огонёк.
      
      
    </div>
    
    <div class="post">
      <h1 class="post-title">
        <a href="https://blog.not-a-kernel-guy.com/2011/03/30/1007/">Инфантилизм как он есть</a>
      </h1>
      <span class="post-date">Mar 30, 2011 &middot; <a href="https://blog.not-a-kernel-guy.com/2011/03/30/1007/#disqus_thread">Comments</a>
      
      <br/>
      <a class="label" href="/tags/%D0%B2%D1%81%D1%8F%D0%BA%D0%B0%D1%8F-%D0%B2%D1%81%D1%8F%D1%87%D0%B8%D0%BD%D0%B0">Всякая всячина</a><a class="label" href="/tags/%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%B0">Работа</a>
      </span>
      
      Попался замечательный топик на Привете. Не берусь сказать правда это или нет – все таки это пересказ через третьи руки. Тем не менее с проявлениями подобного инфантилизма сталкиваюсь чаще, чем хотелось бы.
Оптимистичное начало:
Подскажите, реально ли найти работу тестером после 2-месячных курсов? Человек не имеет никакого ИТ образования, кроме этих 2 месяца курсов с мужиком, которого нашли по газете&hellip;
у человека предыдущее образование связано с социальными каким то науками - что то типа не то десткая психолошия, не то социология и что то с детьми&hellip; То есть ни о каком выше среднего уровне компьютерного пользователя речи не иедт, навыков бухшалтерии нема.
      <a href="https://blog.not-a-kernel-guy.com/2011/03/30/1007/">Read On &rarr;</a>
      
    </div>
    
    <div class="post">
      <h1 class="post-title">
        <a href="https://blog.not-a-kernel-guy.com/2011/03/29/1004/">Нам нужно нарисовать семь красных линий</a>
      </h1>
      <span class="post-date">Mar 29, 2011 &middot; <a href="https://blog.not-a-kernel-guy.com/2011/03/29/1004/#disqus_thread">Comments</a>
      
      <br/>
      <a class="label" href="/tags/%D1%8E%D0%BC%D0%BE%D1%80">Юмор</a>
      </span>
      
      — Так вот, — говорит Морковьева. — Нам нужно нарисовать семь красных линий. Все они должны быть строго перпендикулярны, и кроме того, некоторые нужно нарисовать зеленым цветом, а еще некоторые — прозрачным. Как вы считаете, это реально?
— Нет, — говорит Петров.
— Давайте не будем торопиться с ответом, Петров, — говорит Сидоряхин. — Задача поставлена, и ее нужно решить. Вы же профессионал, Петров. Не давайте нам повода считать, что вы не профессионал.
      <a href="https://blog.not-a-kernel-guy.com/2011/03/29/1004/">Read On &rarr;</a>
      
    </div>
    
    <div class="post">
      <h1 class="post-title">
        <a href="https://blog.not-a-kernel-guy.com/2011/03/21/999/">Про то, как отцепиться и ничего не порушить</a>
      </h1>
      <span class="post-date">Mar 21, 2011 &middot; <a href="https://blog.not-a-kernel-guy.com/2011/03/21/999/#disqus_thread">Comments</a>
      
      <br/>
      <a class="label" href="/tags/%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5">Программирование</a>
      </span>
      
      <p>Главная проблема с хуками состоит не в том, как зацепиться, а в том, как отцепиться и ничего не порушить. К примеру, приходит недавно письмо:</p>
<blockquote>
<p>We recently saw an AV in stress where our vectored exception handler was called after our dll was unloaded.  After investigating the issue, it seems like removing the vectored exception handler does not wait for all users of that exception handler to finish (and does not even remove the exception handler from list for future users if there is one current user).  So, there seems to be no way to synchronize removing the exception handler and the dll unloading – any synchronization within the exception handler is useless since the exception thread may be about to call the exception handler.</p>
</blockquote>
<blockquote>
<p>Недавно мы наблюдали падение приложения во время стрессового тестирования, вызванное тем, что векторный обработчик исключения был вызван после того, как наша DLL была выгружена из памяти. В процессе расследования выяснилось, что, похоже, снятие векторного обработчика исключения не ожидает, пока все пользователи этого обработчика закончат работу (и даже не удаляет обработчик для будущих пользователей, если обработчик в данный момент используется). Так, похоже, что не существует способа синхронизировать снятие векторного обработчика и выгрузку DLL – любая синхронизация в пределах обработчика исключения бесполезна, поскольку поток, в котором произошло исключение, может только готовится вызвать обработчик исключения.</p>
</blockquote>
      <a href="https://blog.not-a-kernel-guy.com/2011/03/21/999/">Read On &rarr;</a>
      
    </div>
    
    <div class="post">
      <h1 class="post-title">
        <a href="https://blog.not-a-kernel-guy.com/2011/03/10/994/">Правильный прототип функции DebugBreak()</a>
      </h1>
      <span class="post-date">Mar 10, 2011 &middot; <a href="https://blog.not-a-kernel-guy.com/2011/03/10/994/#disqus_thread">Comments</a>
      
      <br/>
      <a class="label" href="/tags/%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5">Программирование</a>
      </span>
      
      Функция DebugBreak() объявлена вот таким образом:
void WINAPI DebugBreak(void); Если подумать, то это не очень удачный вариант объявления. Гораздо более удобным вариантом был бы:
void __cdecl DebugBreak(...); Почему? В такую функцию можно передать любой набор параметров. Например, значения переменных интересующих нас в данной точке останова. Или значение нетривиального выражения. А затем в отладчике посмотреть уже готовый результат вместо утомительных попыток понять, куда наш неутомимый компилятор опять заоптимизировал переменную.
      
      
    </div>
    
    <div class="post">
      <h1 class="post-title">
        <a href="https://blog.not-a-kernel-guy.com/2011/02/13/990/">История одной оптимизации</a>
      </h1>
      <span class="post-date">Feb 13, 2011 &middot; <a href="https://blog.not-a-kernel-guy.com/2011/02/13/990/#disqus_thread">Comments</a>
      
      <br/>
      <a class="label" href="/tags/%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5">Программирование</a><a class="label" href="/tags/ndis">NDIS</a>
      </span>
      
      <p><a href="/2011/02/06/972/">Писал я тут свой первый драйвер для сетевой карты</a>. Взял, как полагается, за основу готовый образец драйвера. Выкинул всю аппаратно-зависимую часть. Добавил свою. По ходу дела выяснил, что tear-down код в примере отсутствует напрочь, чтение стандартной конфигурации не сделано, кругом hardcoded константы. В общем, обычная история, что вы хотите от образца?</p>
<p>Дописал до работающего состояния, протестировал скорость TCP/IP соединения. Получается примерно 3 MByte/sec на одно соединение, около 12 MByte/sec – пиковая пропускная способность нескольких параллельных соединений. Маловато для 1 Gbit/sec соединения.</p>
      <a href="https://blog.not-a-kernel-guy.com/2011/02/13/990/">Read On &rarr;</a>
      
    </div>
    
    <div class="post">
      <h1 class="post-title">
        <a href="https://blog.not-a-kernel-guy.com/2011/02/09/986/">Разбор задачи про пакеты</a>
      </h1>
      <span class="post-date">Feb 9, 2011 &middot; <a href="https://blog.not-a-kernel-guy.com/2011/02/09/986/#disqus_thread">Comments</a>
      
      <br/>
      <a class="label" href="/tags/%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D0%B2%D1%8C%D1%8E">Интервью</a>
      </span>
      
      <p>В комментариях к <a href="/2011/02/08/980/">задаче про пакеты</a> было задано много вопросов. Отвечу здесь.</p>
<p>Во-первых, задача действительно простая, иначе никак не уложиться в формат собеседования. На написание кода и сопутствующее общение есть всего около получаса. Плюс писать код на доске сложнее, чем в любимом редакторе. Тем не менее, в задаче любовно набросано граблей, на которые по возможности кандидат должен суметь не наступить. Условие задачи не полное (естественно!), не смотря на кажущееся обилие деталей. Кандидат всегда может прояснить у собеседующего недостающие детали и получить +1 к карме. Либо он может её решить, предположив разумные умолчания. В этом случае собеседующий всегда может добавить недостающее условие к задаче и попросить поправить код соответственно.</p>
      <a href="https://blog.not-a-kernel-guy.com/2011/02/09/986/">Read On &rarr;</a>
      
    </div>
    
    <div class="post">
      <h1 class="post-title">
        <a href="https://blog.not-a-kernel-guy.com/2011/02/08/980/">Задачка на интервью. Пакеты</a>
      </h1>
      <span class="post-date">Feb 8, 2011 &middot; <a href="https://blog.not-a-kernel-guy.com/2011/02/08/980/#disqus_thread">Comments</a>
      
      <br/>
      <a class="label" href="/tags/%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D0%B2%D1%8C%D1%8E">Интервью</a>
      </span>
      
      А хотите задачку, которую я даю претендентам на контрактную позицию в нашей команде? Вот она, родимая. Есть библиотечная функция:
char get_byte(); Функция читает байт из некоего соединения. При необходимости, функция ждет, пока не придет очередной байт. По соединению пересылаются пакеты следующего формата: два байта длины, за которыми следует данные. Длина пакета включает в себя заголовок пакета, т.е. те самые два байта.
Нужно написать функцию recv, получающую очередной пакет:
size_t recv(char* buf, size_t size); В buf передается указатель на буфер, куда должен быть записан пакет (полностью, включая заголовок).
      <a href="https://blog.not-a-kernel-guy.com/2011/02/08/980/">Read On &rarr;</a>
      
    </div>
    
    <div class="post">
      <h1 class="post-title">
        <a href="https://blog.not-a-kernel-guy.com/2011/02/06/972/">NDIS, !ndiskd и DML</a>
      </h1>
      <span class="post-date">Feb 6, 2011 &middot; <a href="https://blog.not-a-kernel-guy.com/2011/02/06/972/#disqus_thread">Comments</a>
      
      <br/>
      <a class="label" href="/tags/%D0%BE%D1%82%D0%BB%D0%B0%D0%B4%D0%BA%D0%B0">Отладка</a><a class="label" href="/tags/ndis">NDIS</a><a class="label" href="/tags/windows">Windows</a><a class="label" href="/tags/windows-kernel">Windows Kernel</a>
      </span>
      
      <p>На работе понадобилось написать драйвер для сетевой карты. Я этого раньше никогда не делал и вообще с <a href="http://msdn.microsoft.com/en-us/library/ms817945.aspx">NDIS</a> дела не имел. А тут такая возможность! Делюсь впечатлениями.</p>
<p>В общем и целом NDIS мне понравился. Интерфейсы довольно логичны, хотя и многочисленны. Взаимосвязь между разными компонентами в большинстве случаев после недолгой медитации становится довольно очевидной. Все структуры снабжены заголовком с сигнатурой, версией и размером, что, помимо заботы об обратной совместимости, означает меньше проблем с отладкой. При необходимости нужную структуру можно просто найти в памяти.</p>
      <a href="https://blog.not-a-kernel-guy.com/2011/02/06/972/">Read On &rarr;</a>
      
    </div>
    
    <ul class="pagination">
  <li class="active">
    <span class="fa-lg"><a href="/page/26/" aria-label="Previous">
        <i class="fa fa-arrow-left" aria-hidden="true"></i>&nbsp;Новое
      </a></span>
  </li>

  <li class="active">
    <span class="fa-lg">
      <a href="/post/">Архив</a>
    <span>
  </li>

  <li class="active">
    <span class="fa-lg"><a href="/page/28/" aria-label="Next">
        Старое&nbsp;<i class="fa fa-arrow-right" aria-hidden="true"></i>
      </a></span>
  </li>
</ul>

  </div>
</div>


<script type="text/javascript">
var disqus_shortname = "alexeypa";
(function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script>

<script src="/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</body>
</html>

